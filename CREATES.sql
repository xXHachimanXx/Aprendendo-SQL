-- Nome: Felipe Andrade Martins
-- Matrícula: 635093


drop database if exists BD2;
create database BD2;
use BD2;

DROP TABLE IF EXISTS ALUNO;
DROP TABLE IF EXISTS ASSUNTO;
DROP TABLE IF EXISTS AUTOR;
DROP TABLE IF EXISTS AUTORIA;
DROP TABLE IF EXISTS EDITORA;
DROP TABLE IF EXISTS EMPRESTIMO;
DROP TABLE IF EXISTS EXEMPLAR;
DROP TABLE IF EXISTS ITEMEMPREST;
DROP TABLE IF EXISTS LIVRO;

-- Questão01
CREATE TABLE AUTOR (
    NOMEAUT VARCHAR(100) NOT NULL,
    CODIGO INT NOT NULL,
    PRIMARY KEY (CODIGO),
    UNIQUE (NOMEAUT)
);
    
CREATE TABLE EDITORA (
    NOMEEDIT VARCHAR(100) NOT NULL,
    CODIGO INT NOT NULL,
    PRIMARY KEY (CODIGO),
    UNIQUE (NOMEEDIT)
);

CREATE TABLE ASSUNTO (
    DESCRICAO VARCHAR(100) NOT NULL,
    CODIGO INT NOT NULL,
    PRIMARY KEY (CODIGO),
    UNIQUE (DESCRICAO)
);


CREATE TABLE LIVRO (
    CODIGO INT NOT NULL,
    TITULO VARCHAR(100) NOT NULL,
    ANOPUBLIC INT,
    CODEDIT INT NOT NULL,
    CODASSUNTO INT NOT NULL,
    PRIMARY KEY (CODIGO),
    FOREIGN KEY (CODEDIT)
        REFERENCES EDITORA (CODIGO),
    FOREIGN KEY (CODASSUNTO)
        REFERENCES ASSUNTO (CODIGO)
);

CREATE TABLE AUTORIA (
    CODLIVRO INT NOT NULL,
    CODAUTOR INT NOT NULL,
    PRIMARY KEY (CODAUTOR, CODLIVRO),
    FOREIGN KEY (CODLIVRO)
        REFERENCES LIVRO (CODIGO),
	FOREIGN KEY (CODAUTOR)
        REFERENCES AUTOR (CODIGO)
);

CREATE TABLE EXEMPLAR (
    CODEXEMPLAR INT NOT NULL,
    CODLIVRO INT NOT NULL,
    DATAAQUISICAO INT NOT NULL,
    VALORAQUISICAO FLOAT,
    PRIMARY KEY (CODEXEMPLAR),
    FOREIGN KEY (CODLIVRO)
        REFERENCES LIVRO (CODIGO)
);

CREATE TABLE ALUNO (
    CODIGO INT NOT NULL,
    NOME TEXT NOT NULL,
    DATANASC DATE NOT NULL,
    CIDADE TEXT NOT NULL,
    PRIMARY KEY (CODIGO)
);

CREATE TABLE EMPRESTIMO (
    CODEMPREST INT NOT NULL,
    DATAEMPREST DATE,
    CODALUNO INT,
    PRIMARY KEY (CODEMPREST),    
    FOREIGN KEY (CODALUNO)
        REFERENCES ALUNO (CODIGO)
);

CREATE TABLE ITEMEMPREST (
    CODEMPRESTITEM INT NOT NULL,
    CODEXEMPLAR INT NOT NULL,
    DATADEVOLUCAO DATE NOT NULL,
    MULTA FLOAT,
    FOREIGN KEY (CODEMPRESTITEM)
        REFERENCES EMPRESTIMO (CODEMPREST),
	FOREIGN KEY (CODEXEMPLAR)
        REFERENCES EXEMPLAR (CODEXEMPLAR)
);   
        
-- Questão 03

